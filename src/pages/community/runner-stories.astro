---
import type { CommunityEntry } from "@/types";
import HeroLayoutWithHTML from "@components/common/HeroLayoutWithHTML.astro";
import { getEntry } from "astro:content";
import sageGreenLogo from "@assets/logo/sage-green-logo.png";

const entry = (await getEntry("community", "runner-stories")) as CommunityEntry;

// Sample runner data - you can replace these with actual runner information
const runners = [
  {
    name: "Sarah Johnson",
    photo: "/src/assets/profile/sarah-johnson.jpg", // You'll need to add actual photos
    story: "I never thought I could run a marathon. When I joined Confluence Running Collective, I was barely able to run a mile without stopping. But with the support of this amazing community of women, I not only completed my first marathon but discovered a strength I never knew I had. The encouragement and camaraderie I found here changed everything for me.",
    achievement: "First Marathon - 2023",
    location: "Minneapolis, MN"
  },
  {
    name: "Maria Rodriguez",
    photo: "/src/assets/profile/maria-rodriguez.jpg",
    story: "After an injury sidelined me for months, I thought my running days were over. The women in this group never gave up on me, even when I wanted to give up on myself. Their encouragement and understanding helped me find my way back to the trails. Now I'm stronger than ever and helping other runners through their own challenges.",
    achievement: "Trail Running Comeback - 2023",
    location: "St. Paul, MN"
  },
  {
    name: "Jennifer Chen",
    photo: "/src/assets/profile/jennifer-chen.jpg",
    story: "I was always intimidated by trail running—the technical terrain, the navigation, the fear of getting lost. But when I found this community, I discovered that trail running isn't just about the physical challenge—it's about the mental strength and the incredible women who run alongside you. Now I lead trail running groups and help other women overcome their fears.",
    achievement: "Trail Running Leader - 2023",
    location: "Duluth, MN"
  },
  {
    name: "Amanda Thompson",
    photo: "/src/assets/profile/amanda-thompson.jpg",
    story: "As a single mom with two kids, finding time to run seemed impossible. But this community showed me that it's not about having hours to spare—it's about making the most of every minute. I started with 15-minute runs during my lunch break and now I'm training for my first ultra-marathon. The support here is incredible.",
    achievement: "Ultra Training - 2024",
    location: "Rochester, MN"
  },
  {
    name: "Lisa Park",
    photo: "/src/assets/profile/lisa-park.jpg",
    story: "I used to think running was a solo sport until I found Confluence Running Collective. The friendships I've made here have transformed not just my running, but my entire life. We celebrate each other's victories, support each other through setbacks, and remind each other that every step forward is progress.",
    achievement: "Community Builder - 2023",
    location: "Mankato, MN"
  },
  {
    name: "Rachel Williams",
    photo: "/src/assets/profile/rachel-williams.jpg",
    story: "After losing my job during the pandemic, running became my therapy. This community gave me a sense of purpose and belonging when I needed it most. The women here taught me that running isn't about being the fastest—it's about being the most supportive version of yourself.",
    achievement: "Mental Health Advocate - 2023",
    location: "Winona, MN"
  }
];
---

<HeroLayoutWithHTML 
  title={entry.data.title}
  description="Stories that inspire, motivate, and connect our community of women runners"
  heroImage={sageGreenLogo}
  heroImageAlt="Runner Stories Hero"
  contentClass="content-beige"
  heroTextClass="text-white"
  heroOverlayOpacity={70}
  heroMinHeight="min-h-[60vh]"
>
  <!-- Introduction Section -->
  <div class="max-w-4xl mx-auto text-center mb-16">
    <h2 class="text-3xl font-bold mb-6">Stories That Inspire</h2>
    <p class="text-lg leading-relaxed">
      Every runner has a story. Here, we share the journeys, challenges, and triumphs of women in our community. 
      These stories remind us that we're not alone in our running journey and that every step forward is a victory worth celebrating.
    </p>
  </div>

  <!-- Runner Stories Grid -->
  <div class="max-w-7xl mx-auto">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" style="grid-auto-rows: minmax(auto, auto);">
      {
        runners.map((runner, index) => {
          const initials = runner.name.split(' ').map(n => n[0]).join('');
          const cardId = `card-${index}`;
          return (
            <div 
              id={cardId}
              class="runner-card glass rounded-lg overflow-hidden hover:shadow-xl transition-all duration-500 cursor-pointer transform"
              data-card-id={cardId}
            >
                             <!-- Runner Photo -->
               <div class="relative h-64 bg-gradient-to-br from-lightgreen-txt-p to-lightgreen-txt-s transition-all duration-700">
                 <div class="absolute inset-0 flex items-center justify-center">
                   <div class="w-32 h-32 bg-[rgb(246,242,232)] rounded-full flex items-center justify-center shadow-lg transition-all duration-700">
                     <span class="text-4xl font-bold text-lightgreen-txt-p transition-all duration-700">
                       {initials}
                     </span>
                   </div>
                 </div>
               </div>
               
               <!-- Runner Info -->
               <div class="p-6 transition-all duration-700">
                <h3 class="text-xl text-glass-txt-p font-bold mb-2">{runner.name}</h3>
                <p class="text-sm text-glass-txt-p font-semibold mb-3">{runner.achievement}</p>
                <p class="text-sm text-glass-txt-p mb-2">{runner.location}</p>
                <p class="leading-relaxed text-glass-txt-p line-clamp-4">
                  {runner.story}
                </p>
                <button class="mt-4 text-lightgreen-txt-p font-semibold hover:text-lightgreen-txt-s transition-colors duration-200">
                  Read Full Story →
                </button>
              </div>
            </div>
          );
        })
      }
         </div>
   </div>

           
 </HeroLayoutWithHTML>

<!-- Lightbox Overlay - Positioned outside HeroLayoutWithHTML to overlay entire page -->
<div id="lightbox" class="lightbox">
  <div class="lightbox-content">
   <button class="lightbox-close">&times;</button>
   <div class="lightbox-header">
     <div class="lightbox-avatar">
       <span id="lightbox-initials"></span>
     </div>
     <div class="lightbox-info">
       <h3 id="lightbox-name"></h3>
       <p id="lightbox-achievement"></p>
       <p id="lightbox-location"></p>
     </div>
   </div>
   <div class="lightbox-body">
     <p id="lightbox-story"></p>
   </div>
 </div>
</div>

<style>
  .line-clamp-4 {
    display: -webkit-box;
    -webkit-line-clamp: 4;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
     .runner-card {
     transition: all 0.3s ease;
     margin: 0.5rem;
   }
   
   /* Enhanced hover effects */
   .runner-card:hover {
     transform: translateY(-2px);
     box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
   }
   
                                                               /* Lightbox Styles */
       .lightbox {
         position: fixed;
         top: 0;
         left: 0;
         width: 100vw;
         height: 100vh;
         z-index: 9999;
         display: none;
         align-items: center;
         justify-content: center;
         background: rgba(0, 0, 0, 0.8);
         backdrop-filter: blur(4px);
       }
    
    .lightbox.show {
      display: flex;
    }
    
    .lightbox-content {
      background: rgb(246, 242, 232);
      border-radius: 12px;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      position: relative;
      animation: lightboxSlideIn 0.3s ease-out;
    }
    
    @keyframes lightboxSlideIn {
      from {
        opacity: 0;
        transform: scale(0.8);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }
   
   .lightbox-close {
     position: absolute;
     top: 1rem;
     right: 1rem;
     background: none;
     border: none;
     font-size: 2rem;
     color: #666;
     cursor: pointer;
     z-index: 10;
     width: 40px;
     height: 40px;
     border-radius: 50%;
     display: flex;
     align-items: center;
     justify-content: center;
     transition: all 0.2s ease;
   }
   
   .lightbox-close:hover {
     background: rgba(0, 0, 0, 0.1);
     color: #333;
   }
   
   .lightbox-header {
     display: flex;
     align-items: center;
     gap: 1.5rem;
     padding: 2rem 2rem 1rem 2rem;
     border-bottom: 1px solid rgba(0, 0, 0, 0.1);
   }
   
   .lightbox-avatar {
     width: 80px;
     height: 80px;
     background: linear-gradient(135deg, #4a7c59, #6b8e5f);
     border-radius: 50%;
     display: flex;
     align-items: center;
     justify-content: center;
     flex-shrink: 0;
   }
   
   .lightbox-avatar span {
     font-size: 2rem;
     font-weight: bold;
     color: rgb(246, 242, 232);
   }
   
   .lightbox-info h3 {
     font-size: 1.5rem;
     font-weight: bold;
     color: #333;
     margin: 0 0 0.5rem 0;
   }
   
   .lightbox-info p {
     margin: 0.25rem 0;
     color: #666;
     font-size: 0.9rem;
   }
   
   .lightbox-info p:first-of-type {
     font-weight: 600;
     color: #4a7c59;
   }
   
   .lightbox-body {
     padding: 1.5rem 2rem 2rem 2rem;
   }
   
   .lightbox-body p {
     line-height: 1.7;
     color: #333;
     font-size: 1rem;
     margin: 0;
   }
   
   @media (max-width: 768px) {
     .lightbox-content {
       width: 95%;
       max-height: 90vh;
     }
     
     .lightbox-header {
       flex-direction: column;
       text-align: center;
       gap: 1rem;
       padding: 1.5rem 1.5rem 1rem 1.5rem;
     }
     
     .lightbox-body {
       padding: 1rem 1.5rem 1.5rem 1.5rem;
     }
   }
</style>

<script is:inline>
  // Lightbox functionality - runs on every page visit
  (function() {
    // Wait for DOM to be ready
    function initLightbox() {
      const cards = document.querySelectorAll('.runner-card');
      const lightbox = document.getElementById('lightbox');
      const lightboxClose = document.querySelector('.lightbox-close');
      
      if (!cards.length || !lightbox || !lightboxClose) {
        // If elements aren't ready yet, try again in a moment
        setTimeout(initLightbox, 100);
        return;
      }
      
      // Runner data for the lightbox
      const runners = [
        {
          name: "Sarah Johnson",
          story: "I never thought I could run a marathon. When I joined Confluence Running Collective, I was barely able to run a mile without stopping. But with the support of this amazing community of women, I not only completed my first marathon but discovered a strength I never knew I had. The encouragement and camaraderie I found here changed everything for me.",
          achievement: "First Marathon - 2023",
          location: "Minneapolis, MN"
        },
        {
          name: "Maria Rodriguez",
          story: "After an injury sidelined me for months, I thought my running days were over. The women in this group never gave up on me, even when I wanted to give up on myself. Their encouragement and understanding helped me find my way back to the trails. Now I'm stronger than ever and helping other runners through their own challenges.",
          achievement: "Trail Running Comeback - 2023",
          location: "St. Paul, MN"
        },
        {
          name: "Jennifer Chen",
          story: "I was always intimidated by trail running—the technical terrain, the navigation, the fear of getting lost. But when I found this community, I discovered that trail running isn't just about the physical challenge—it's about the mental strength and the incredible women who run alongside you. Now I lead trail running groups and help other women overcome their fears.",
          achievement: "Trail Running Leader - 2023",
          location: "Duluth, MN"
        },
        {
          name: "Amanda Thompson",
          story: "As a single mom with two kids, finding time to run seemed impossible. But this community showed me that it's not about having hours to spare—it's about making the most of every minute. I started with 15-minute runs during my lunch break and now I'm training for my first ultra-marathon. The support here is incredible.",
          achievement: "Ultra Training - 2024",
          location: "Rochester, MN"
        },
        {
          name: "Lisa Park",
          story: "I used to think running was a solo sport until I found Confluence Running Collective. The friendships I've made here have transformed not just my running, but my entire life. We celebrate each other's victories, support each other through setbacks, and remind each other that every step forward is progress.",
          achievement: "Community Builder - 2023",
          location: "Mankato, MN"
        },
        {
          name: "Rachel Williams",
          story: "After losing my job during the pandemic, running became my therapy. This community gave me a sense of purpose and belonging when I needed it most. The women here taught me that running isn't about being the fastest—it's about being the most supportive version of yourself.",
          achievement: "Mental Health Advocate - 2023",
          location: "Winona, MN"
        }
      ];
      
      function openLightbox(index) {
        const runner = runners[index];
        const initials = runner.name.split(' ').map(n => n[0]).join('');
        
        // Populate lightbox content
        document.getElementById('lightbox-initials').textContent = initials;
        document.getElementById('lightbox-name').textContent = runner.name;
        document.getElementById('lightbox-achievement').textContent = runner.achievement;
        document.getElementById('lightbox-location').textContent = runner.location;
        document.getElementById('lightbox-story').textContent = runner.story;
        
        // Show lightbox
        lightbox.classList.add('show');
        
        // Prevent body scroll
        document.body.style.overflow = 'hidden';
      }
      
      function closeLightbox() {
        lightbox.classList.remove('show');
        document.body.style.overflow = '';
      }
      
      // Remove any existing event listeners by cloning and replacing elements
      cards.forEach((card, index) => {
        const newCard = card.cloneNode(true);
        card.parentNode.replaceChild(newCard, card);
        
        newCard.addEventListener('click', function() {
          openLightbox(index);
        });
      });
      
      // Close lightbox on close button click
      lightboxClose.addEventListener('click', closeLightbox);
      
      // Close lightbox on background click
      lightbox.addEventListener('click', function(e) {
        if (e.target === lightbox) {
          closeLightbox();
        }
      });
      
      // Close lightbox on escape key
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && lightbox.classList.contains('show')) {
          closeLightbox();
        }
      });
    }
    
    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initLightbox);
    } else {
      initLightbox();
    }
    
    // Also initialize on Astro page transitions
    document.addEventListener('astro:page-load', initLightbox);
  })();
</script> 